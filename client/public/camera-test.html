<!DOCTYPE html>
<html>
<head>
  <title>Camera Test</title>
</head>
<body>
  <h1>Camera Test</h1>
  <button onclick="runTest()">Run Camera Test</button>
  <div id="results"></div>
  
  <script>
    async function runTest() {
      const results = document.getElementById('results');
      results.innerHTML = '<h2>Running Camera Tests...</h2>';
      
      // Test 1: Browser Support
      results.innerHTML += '<h3>Test 1: Browser Support</h3>';
      if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
        results.innerHTML += '<p>✅ Browser supports getUserMedia</p>';
      } else {
        results.innerHTML += '<p>❌ Browser does NOT support getUserMedia</p>';
      }
      
      // Test 2: Permission State
      results.innerHTML += '<h3>Test 2: Permission State</h3>';
      try {
        const permission = await navigator.permissions.query({name: 'camera'});
        results.innerHTML += `<p>Camera permission state: ${permission.state}</p>`;
      } catch (e) {
        results.innerHTML += `<p>Permission query error: ${e.message}</p>`;
      }
      
      // Test 3: Camera Access
      results.innerHTML += '<h3>Test 3: Camera Access</h3>';
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });
        results.innerHTML += '<p>✅ Camera access SUCCESS</p>';
        results.innerHTML += `<p>Video tracks: ${stream.getVideoTracks().length}</p>`;
        
        // Stop immediately
        stream.getTracks().forEach(track => track.stop());
      } catch (error) {
        results.innerHTML += `<p>❌ Camera access FAILED: ${error.name} - ${error.message}</p>`;
      }
      
      results.innerHTML += '<h2>Test Complete</h2>';
    }
  </script>
</body>
</html>
